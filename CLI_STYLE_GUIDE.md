# CLI 表示ルール

セットアップスクリプトにおける CLI の表示・対話ルールを定義する。

## 1. 起動時のステップ一覧表示

スクリプト起動時に、実行されるステップの一覧を表示する。
各ステップは `[現在/合計]` の形式で番号付けし、何を実施するかを明示する。

```
[1/4] 環境をチェックしています...
[2/4] 既存ファイルを確認しています...
[3/4] ファイルをダウンロードしています...
[4/4] .bashrc の設定を確認しています...
```

### 実装パターン

```bash
TOTAL_STEPS=4

step 1 $TOTAL_STEPS "環境をチェックしています..."
# ... 処理 ...
step 2 $TOTAL_STEPS "既存ファイルを確認しています..."
# ... 処理 ...
```

## 2. 主要処理の確認プロンプト (y/N)

各ステップにおける主要なインストール・設定変更処理の前には、必ず `y/N` の確認プロンプトを表示する。

- デフォルトは `N`（実行しない）
- `--force` オプション指定時は確認をスキップする

### 確認が必要な操作

- ファイルのダウンロード・配置
- 既存ファイルの上書き（バックアップ後）
- 設定ファイル（`.bashrc` 等）への追記
- パッケージのインストール

### 実装パターン

```bash
if confirm "既存ファイルをバックアップして上書きしますか？"; then
    # 処理を実行
else
    info "セットアップを中止しました"
    exit 0
fi
```

## 3. 警告 (warn) の使い分け

### warn を出すケース

- 既存ファイルが検出された場合
  ```
  ⚠  既存ファイルを検出: ~/.git-completion.bash
  ⚠  .vimrc が既に存在します: ~/.vimrc
  ```
- 処理がスキップされた場合
  ```
  ⚠  .bashrc への設定追加をスキップしました
  ```
- 環境の制約が検出された場合
  ```
  ⚠  sudo が利用できません。ソースから vim をビルドします...
  ```

### warn を出さないケース

- ダウンロード対象のファイルがまだ存在しない場合（正常な状態のため）
  - 代わりに `info` で新規作成する旨を表示する
  ```
  ℹ  既存ファイルはありません。新規ダウンロードします
  ℹ  .vimrc は存在しません。新規作成します
  ```

## 4. 出力関数の使い分け

| 関数 | アイコン | 色 | 用途 |
|------|---------|------|------|
| `info` | `ℹ` | 青 | 情報表示（配置先パス、次の操作案内など） |
| `success` | `✓` | 緑 | 処理の成功 |
| `warn` | `⚠` | 黄 | 警告（既存ファイル検出、スキップなど） |
| `error` | `✗` | 赤 | エラー（処理失敗、必須コマンド不足など） |
| `step` | `[n/N]` | シアン | ステップの進行表示 |
| `header` | - | 太字 | スクリプト起動時のタイトル表示 |

## 5. スクリプトの全体構成

```
header "Script Title"
  ├── step 1: 環境チェック（require_command など）
  ├── step 2: 既存ファイルの確認（warn + confirm）
  ├── step 3: ダウンロード・インストール（spinner + confirm）
  ├── step N: 設定ファイルの更新（confirm）
  └── 完了メッセージ（success + info で次の手順を案内）
```
